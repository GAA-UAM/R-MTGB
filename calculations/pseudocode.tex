\documentclass{article}
\usepackage{amsmath}
\usepackage{algorithm}
\usepackage{algorithmic}

\begin{document}

\begin{algorithm}
    \caption{Update Ensemble - First Stage}
    \begin{algorithmic}[1]
        \STATE \textbf{Input:} Ensemble $E$, Data $D$
        \STATE Compute predictions $P$ using $E$
        \STATE Compute gradient $G_{ch} = -(Y - P)$
        \STATE Train predictor on $(X, -G_{ch})$ 
        \STATE Add trained model to $E$
        \STATE \textbf{Return:} Updated Ensemble $E$
    \end{algorithmic}
\end{algorithm}

\begin{algorithm}
    \caption{Update Ensemble - Second Stage}
    \begin{algorithmic}[1]
        \STATE \textbf{Input:} Ensemble $E$, Data $D$, Learning Rate $\eta$
        \STATE Compute predictions $P$ using $E$
        \STATE Compute gradient components:
        \STATE \quad $G_{ch}^{non-out} = -(Y - P) (1 - \sigma(\theta))$
        \STATE \quad $G_{ch}^{out} = -(Y - P) \sigma(\theta)$
        \STATE Compute $\nabla_{\theta}$:
        \STATE \quad $\nabla_{\theta} = (Y - P) P_{ch}^{non-out} \sigma(\theta) - (Y - P) P_{ch}^{out} (1 - \sigma(\theta))$
        \STATE Update $\theta = \theta - \eta \nabla_{\theta}$
        \STATE Train predictor on $(X, -G_{ch}^{non-out})$ and add to $E$
        \STATE Train predictor on $(X, -G_{ch}^{out})$ and add to $E$
        \STATE \textbf{Return:} Updated Ensemble $E$
    \end{algorithmic}
\end{algorithm}

\begin{algorithm}
    \caption{Update Ensemble - Third Stage}
    \begin{algorithmic}[1]
        \STATE \textbf{Input:} Ensemble $E$, Data $D$
        \STATE Compute predictions $P$ using $E$
        \STATE Compute gradient $G_{rh} = -(Y - P)$
        \STATE Train predictor on $(X, -G_{rh})$ per task and add to $E$
        \STATE \textbf{Return:} Updated Ensemble $E$
    \end{algorithmic}
\end{algorithm}

\end{document}